?abline
?line
?lines
lines(painot~pituudet)
lines(painot~pituudet)
pituudet <- c(46.5, 49, 53)
painot <- c(2670, 3100, 3930)
lines(painot~pituudet)
plot(painot, pituudet)
lines(painot~pituudet)
lines(painot~pituudet)
plot(painot, pituudet)
lines(painot~pituudet)
plot(painot, pituudet, type = "b")
plot(painot, pituudet, pch = 16)
plot(painot, pituudet, pch = 20)
plot(painot, pituudet, pch = 10)
plot(painot, pituudet, pch = 12)
plot(painot, pituudet, pch = 16)
plot(painot, pituudet, pch = 17)
plot(painot, pituudet, pch = 15)
plot(painot, pituudet, pch = 16)
plot(painot, pituudet, pch = 16, col = "red")
plot(painot, pituudet, pch = 16, col = "red", xlab = "Paino (g)", ylab = "Pituus(cm)")
plot(painot, pituudet, pch = 16, col = "red", xlab = "Paino (g)", ylab = "Pituus(cm)", cex = 1,5)
plot(painot, pituudet, pch = 16, col = "red", xlab = "Paino (g)", ylab = "Pituus(cm)", cex = 1.5)
plot(painot, pituudet, pch = 16, col = "red", xlab = "Paino (g)", ylab = "Pituus(cm)", cex = 15)
plot(painot, pituudet, pch = 16, col = "red", xlab = "Paino (g)", ylab = "Pituus(cm)", cex = 1,2)
plot(painot, pituudet, pch = 16, col = "red", xlab = "Paino (g)", ylab = "Pituus(cm)", cex = 1.2)
lm(pituudet~painot)
abline(lm(pituudet~painot))
plot(painot, pituudet, xlim = c(0,10000) pch = 16, col = "red", xlab = "Paino (g)", ylab = "Pituus(cm)", cex = 1.2)
plot(painot, pituudet, xlim = c(0,10000), pch = 16, col = "red", xlab = "Paino (g)", ylab = "Pituus(cm)", cex = 1.2)
plot(painot, pituudet, xlim = c(0,10000), ylim=c(0,200), pch = 16, col = "red", xlab = "Paino (g)", ylab = "Pituus(cm)", cex = 1.2)
abline(lm(pituudet~painot))
plot(painot, pituudet, xlim = c(0,50000), ylim=c(0,200), pch = 16, col = "red", xlab = "Paino (g)", ylab = "Pituus(cm)", cex = 1.2)
abline(lm(pituudet~painot))
plot(painot, pituudet, xlim = c(0,25000), ylim=c(0,200), pch = 16, col = "red", xlab = "Paino (g)", ylab = "Pituus(cm)", cex = 1.2)
abline(lm(pituudet~painot))
plot(painot, pituudet, xlim = c(0,20000), ylim=c(0,200), pch = 16, col = "red", xlab = "Paino (g)", ylab = "Pituus(cm)", cex = 1.2)
abline(lm(pituudet~painot))
plot(painot, pituudet, xlim = c(0,30000), ylim=c(0,200), pch = 16, col = "red", xlab = "Paino (g)", ylab = "Pituus(cm)", cex = 1.2)
abline(lm(pituudet~painot))
plot(painot, pituudet, xlim = c(0,100), ylim=c(0,200), pch = 16, col = "red", xlab = "Paino (kg)", ylab = "Pituus(cm)", cex = 1.2)
abline(lm(pituudet~painot))
plot(painot, pituudet, xlim = c(0,5), ylim=c(0,200), pch = 16, col = "red", xlab = "Paino (kg)", ylab = "Pituus(cm)", cex = 1.2)
plot(painot, pituudet, pch = 16, col = "red", xlab = "Paino (kg)", ylab = "Pituus(cm)", cex = 1.2)
painot <- c(2.670, 3.100, 3.930)
pituudet <- c(46.5, 49, 53)
painot <- c(2.670, 3.100, 3.930)
plot(painot, pituudet, xlim = c(0,5), ylim=c(0,200), pch = 16, col = "red", xlab = "Paino (kg)", ylab = "Pituus(cm)", cex = 1.2)
abline(lm(pituudet~painot))
plot(painot, pituudet, xlim = c(0,100), ylim=c(0,200), pch = 16, col = "red", xlab = "Paino (kg)", ylab = "Pituus(cm)", cex = 1.2)
abline(lm(pituudet~painot))
plot(painot, pituudet, xlim = c(0,40), ylim=c(0,200), pch = 16, col = "red", xlab = "Paino (kg)", ylab = "Pituus(cm)", cex = 1.2)
abline(lm(pituudet~painot))
plot(painot, pituudet, xlim = c(0,80), ylim=c(0,400), pch = 16, col = "red", xlab = "Paino (kg)", ylab = "Pituus(cm)", cex = 1.2)
abline(lm(pituudet~painot))
lm(pituudet~painot)
33*49+5.1
5.1*3.1+33
abline(x = 74)
abline(a = 74)
abline(a=74)
?abline
abline(v=74)
abline(h=184)
abline(v=74, col = "green")
abline(h=184, col = "blue")
plot(painot, pituudet, xlim = c(0,80), ylim=c(0,450), pch = 16, col = "red", xlab = "Paino (kg)", ylab = "Pituus(cm)", cex = 1.2)
abline(lm(pituudet~painot))
abline(v=74, col = "green")
abline(h=184, col = "blue")
lm(pituudet~painot)
5.113*74+33
(184-33)/5.1
plot(painot, pituudet, xlim = c(0,80), ylim=c(0,450), pch = 16, col = "red", xlab = "Paino (kg)", ylab = "Pituus(cm)", cex = 0.8)
plot(painot, pituudet, xlim = c(0,80), ylim=c(0,450), pch = 16, col = "red", xlab = "Paino (kg)", ylab = "Pituus(cm)", cex = 0.7)
plot(painot, pituudet, xlim = c(0,80), ylim=c(0,450), pch = 16, col = "red", xlab = "Paino (kg)", ylab = "Pituus(cm)", cex = 0.5)
abline(lm(pituudet~painot))
abline(v=74, col = "green")
abline(h=184, col = "blue")
pituudet <- c(46.5, 49, 53)
painot <- c(2.670, 3.100, 3.930)
plot(painot, pituudet, xlim = c(0,80), ylim=c(0,450), pch = 16, col = "red", xlab = "Paino (kg)", ylab = "Pituus(cm)", cex = 0.8)
abline(lm(pituudet~painot))
abline(v=74, col = "green")
abline(h=184, col = "blue")
reiluNoppa <- function(heittomaara) {
todennakoisyydet <- c(rep(1/6, 6))
}
rep(1/6,6)
c(rep(1/6,6))
seq(1:6)
todennakoisyydet <- rep(1/6, 6)
silmaluvut <- seq(1:6)
sample(1:6,heittomaara)
reiluNoppa <- function(heittomaara) {
todennakoisyydet <- rep(1/6, 6)
silmaluvut <- seq(1:6)
sample(1:6,heittomaara)
}
reiluNoppa(10)
reiluNoppa <- function(heittomaara) {
todennakoisyydet <- rep(1/6, 6)
silmaluvut <- seq(1:6)
sample(1:6,heittomaara, replace = T)
}
reiluNoppa(10)
reiluNoppa(10)
reiluNoppa(10)
reiluNoppa(10)
reiluNoppa(10)
reiluNoppa(10)
reiluNoppa <- function(heittomaara) {
todennakoisyydet <- rep(1/6, 6)
silmaluvut <- seq(1:6)
sample(1:6,heittomaara, replace = T, prob = todennakoisyydet)
}
reiluNoppa(10)
reiluNoppa <- function(heittomaara) {
todennakoisyydet <- c(0.1,0.1,0.1,0.1,0.1,0.5)
silmaluvut <- seq(1:6)
sample(1:6,heittomaara, replace = T, prob = todennakoisyydet)
}
reiluNoppa(10)
hist(reiluNoppa(100))
hist(reiluNoppa(1000))
hist(reiluNoppa(10000))
hist(reiluNoppa(10000000))
sample(1:5, 5, replace = F)
1:5
seq(1:5)
summary(l2014)
```{r}
l2014 <- read.table("/home/juhana/Desktop/IODS-project/learning2014.txt", sep = ",", header = T)
str(l2014)
head(l2014)
summary(l2014)
summary(l2014)
library(ggplot2)
library(GGally)
ggpairs(l2014, mapping = aes(col = gender, alpha = 0.3), lower = list(combo = wrap("facethist", bins = 20)))
pairs(learning2014[-1], col = learning2014$gender)
pairs(l2014[-1], col = learning2014$gender)
pairs(l2014[-1], col = learning2014$gender)
pairs(l2014[-1], col = learning2014$gender)
pairs(l2014[-1], col = learning2014$gender)
pairs(l2014[-1], col = l2014$gender)
summary(points~age+attitude+stra, data=l2014)
summary(lm(points~age+attitude+stra, data=l2014))
summary(lm(points~deep+attitude+surf, data=l2014))
summary(lm(points~deep+attitude+gender, data=l2014))
summary(lm(points~age+attitude+stra, data=l2014))
l2014 <- read.table("/home/juhana/Desktop/IODS-project/learning2014.txt", sep = ",", header = T)
str(l2014)
head(l2014)
summary(l2014)
library(ggplot2)
library(GGally)
ggpairs(l2014, mapping = aes(col = gender, alpha = 0.3), lower = list(combo = wrap("facethist", bins = 20)))
summary(lm.(points~attitude,data=l2014))
summary(lm(points~attitude,data=l2014))
library(ggplot2)
library(GGally)
update.packages("ggplot2")
install.packages("ggplot2")
options()
?options
options[warn=-1]
options
options()
options(warn = -1)
options(warn = -100)
options(nwarnings = 0)
options(nwarnings = 1)
plot(lm(points~attitude, data=l2014), which = c(1,2,5), par(mrow = c(2,2)))
summary(lm(points~attitude,data=l2014))
ggpairs(l2014, mapping = aes(col = gender, alpha = 0.3), lower = list(combo = wrap("facethist", bins = 20)))
library(ggplot2)
library(GGally)
ggpairs(l2014, mapping = aes(col = gender, alpha = 0.3), lower = list(combo = wrap("facethist", bins = 20)))
plot(l2014$points~l2014$attitude)
lines(lm(l2014$points~l2014$attitude))
lm(l2014$points~l2014$attitude)
lines(3.525,11.637)
lines(11.637,3.525)
summary(lm(points~attitude,data=l2014))
qplot(attitude, points, data = learning2014) + geom_smooth(method = "lm")
qplot(attitude, points, data = l2014) + geom_smooth(method = "lm")
plot(lm(points~attitude, data=l2014), which = 1, par(mrow = c(2,2)))
plot(lm(points~attitude, data=l2014), which = 1, )
plot(lm(points~attitude, data=l2014), which = c(1,2,5), par(mfrow=c(2,2)) )
plot(lm(points~attitude, data=l2014), which = c(1,2,5), par(mfrow=c(1,3)) )
plot(lm(points~attitude, data=l2014), which = c(1,2,5), par(mfrow=c(3,1)) )
plot(lm(points~attitude, data=l2014), which = c(1,2,5), par(mfrow=c(3,3)) )
options()
options(warn = -10)
options()
options(save)
options(save())
options()
options()
options()
option(warning = FALSE)
# Juhana Rautavirta
# 10.2.2017
# This data is about alcohol consumption among Portuguese students
# https://archive.ics.uci.edu/ml/datasets/STUDENT+ALCOHOL+CONSUMPTION
# Reading the two datasets
math <- read.csv("/home/juhana/Desktop/IODS-project/data/student-mat.csv", sep = ";", header = T)
por <- read.csv("/home/juhana/Desktop/IODS-project/data/student-por.csv", sep = ";", header = T)
# Exploring the structure and dimension
str(math)
dim(math)
str(por)
dim(por)
library(dplyr)
# This are the variables that identify the same students
join_by <- c("school", "sex", "age", "address", "famsize", "Pstatus", "Medu", "Fedu", "Mjob", "Fjob", "reason", "nursery","internet")
# Joining the two datasets
math_por <- inner_join(math, por, by = join_by, suffix = c(".math", ".por"))
str(math_por)
dim(math_por)
alc <- select(math_por, one_of(join_by))
notjoined_columns <- colnames(math)[!colnames(math) %in% join_by]
for(column_name in notjoined_columns) {
two_columns <- select(math_por, starts_with(column_name))
first_column <- select(two_columns, 1)[[1]]
if(is.numeric(first_column)) {
alc[column_name] <- round(rowMeans(two_columns))
} else {
alc[column_name] <- first_column
}
}
# Creating a new column of alcohol usage on weeks and weekends and another column
# of high usage of alcohol
alc <- mutate(alc, alc_use = (Dalc + Walc)/2)
alc <- mutate(alc, high_use = alc_use > 2)
glimpse(alc)
setwd("/home/juhana/Desktop/IODS-project/data")
write.csv(x = alc, file = "alc.csv")
knitr::opts_chunk$set(echo = TRUE)
# Chapter 3 - Logistic Regression
```{r}
alc <- read.table("/home/juhana/Desktop/IODS-project/data/alc.csv", sep = ",", header = T)
```
alc <- read.table("/home/juhana/Desktop/IODS-project/data/alc.csv", sep = ",", header = T)
alc <- read.table("/home/juhana/Desktop/IODS-project/data/alc.csv", sep = ",", header = T)
alc
head(alc)
colnames(alc)
alc <- read.table("/home/juhana/Desktop/IODS-project/data/alc.csv", sep = ",", header = T)
library(ggplot2)
alc <- read.table("/home/juhana/Desktop/IODS-project/data/alc.csv", sep = ",", header = T)
library(ggplot2)
g1 <- ggplot(alc, aes(x=high_use, y=famrel))
g1 <- ggplot(alc, aes(x=high_use, y=famrel))
g1 <- ggplot(alc, aes(x=high_use, y=famrel))
g1 <- ggplot(alc, aes(x=high_use, y=famrel))
g1 + geom_boxplot()
g1 <- ggplot(alc, aes(x=high_use, y=famrel))
g1 + geom_boxplot() + ylab("Family relationships") + ggtitle("Family relationships vs high usage of alcohol")
g1 <- ggplot(alc, aes(x=high_use, y=famrel))
g1 + geom_barplot() + ylab("Family relationships") + ggtitle("Family relationships vs high usage of alcohol")
g1 <- ggplot(alc, aes(x=high_use, y=famrel))
g1 + geom_bar() + ylab("Family relationships") + ggtitle("Family relationships vs high usage of alcohol")
g1 <- ggplot(alc, aes(x=high_use, y=famrel))
g1 + geom_boxplot() + ylab("Family relationships") + ggtitle("Family relationships vs high usage of alcohol")
g1 <- ggplot(alc, aes(x=high_use, y=famrel))
g1 + geom_boxplot() + ylab+ xlab("High usage of alcohol") + ggtitle("Family relationships vs high usage of alcohol")
g1 <- ggplot(alc, aes(x=high_use, y=famrel))
g1 + geom_boxplot() + ylab("Family relationships")+ xlab("High usage") + ggtitle("Family relationships vs high usage of alcohol")
g1 <- ggplot(alc, aes(x=high_use, y=famrel, col = sex))
g1 + geom_boxplot() + ylab("Family relationships")+ xlab("High usage") + ggtitle("Family relationships vs high usage of alcohol")
g2 <- ggplot(alc, aes(x = high_use, y=famsup))
g2 + geom_boxplot()
g2 <- ggplot(alc, aes(x = high_use, y=famsup)) + geom_point(aes(size = value), colour = "green") + theme_bw() + xlab("") + ylab("")
g2 + scale_size_continuous(range=c(10,30)) + geom_text(aes(label = value))
g2 <- ggplot(alc, aes(x = high_use, y=famsup)) + geom_point( colour = "green") + theme_bw() + xlab("") + ylab("")
g2 + scale_size_continuous(range=c(10,30))
g2 <- ggplot(alc, aes(x = high_use, y=famsup)) + geom_point( colour = "green") + theme_bw()
g2 + scale_size_continuous(range=c(10,30))
values <- rep(x = 0, 4)
values
sum(alc$high_use = F & alc$famsup = F)
sum(alc$high_use & alc$famsup)
sum(alc$high_use && alc$famsup)
sum(alc$high_use)
sum(alc$famsup)
alc$famsup
alc$high_use
sum(alc$high_use && 1==2)
sum(alc$high_use && 1==1)
sum(alc$high_use && 1=1)
sum((alc$high_use) && (1==1))
sum((alc$high_use) && (T))
sum(alc$famsu)
sum(alc$famsup == "yes")
sum((alc$high_use) | (alc$famsup == "yes"))
sum((alc$high_use) & (alc$famsup == "yes"))
sum((alc$high_use) && (alc$famsup == "yes"))
values[1]<- sum((alc$high_use) & (alc$famsup == "yes"))
sum((!alc$high_use) && (alc$famsup == "yes"))
sum((alc$high_use) && (alc$famsup == "yes"))
sum((alc$high_use) & (alc$famsup == "yes"))
sum((!alc$high_use) & (alc$famsup == "yes"))
values[1]<- sum((!alc$high_use) & (alc$famsup == "no"))
values[2]<- sum((alc$high_use) & (alc$famsup == "no"))
values[3]<- sum((!alc$high_use) & (alc$famsup == "yes"))
values[4]<- sum((alc$high_use) & (alc$famsup == "yes"))
values
values <- rep(x = 0, 4)
values[1]<- sum((!alc$high_use) & (alc$famsup == "no"))
values[2]<- sum((alc$high_use) & (alc$famsup == "no"))
values[3]<- sum((!alc$high_use) & (alc$famsup == "yes"))
values[4]<- sum((alc$high_use) & (alc$famsup == "yes"))
g2 <- ggplot(alc, aes(x = high_use, y=famsup)) + geom_point(aes(size = values), colour = "green") + theme_bw()
g2 + scale_size_continuous(range=c(10,30))
values <- rep(x = 0, 4)
values[1]<- sum((!alc$high_use) & (alc$famsup == "no"))
values[2]<- sum((alc$high_use) & (alc$famsup == "no"))
values[3]<- sum((!alc$high_use) & (alc$famsup == "yes"))
values[4]<- sum((alc$high_use) & (alc$famsup == "yes"))
df <- expand.grid(c("High", "Low"), c("No support", "Support"))
g2 <- ggplot(df, aes(x = high_use, y=famsup)) + geom_point(aes(size = values), colour = "green") + theme_bw()
g2 + scale_size_continuous(range=c(10,30))
values <- rep(x = 0, 4)
values[1]<- sum((!alc$high_use) & (alc$famsup == "no"))
values[2]<- sum((alc$high_use) & (alc$famsup == "no"))
values[3]<- sum((!alc$high_use) & (alc$famsup == "yes"))
values[4]<- sum((alc$high_use) & (alc$famsup == "yes"))
df <- expand.grid(c("High", "Low"), c("No support", "Support"))
g2 <- ggplot(df, aes(x = Var1, y=famsup)) + geom_point(aes(size = values), colour = "green") + theme_bw()
g2 + scale_size_continuous(range=c(10,30))
values <- rep(x = 0, 4)
values[1]<- sum((!alc$high_use) & (alc$famsup == "no"))
values[2]<- sum((alc$high_use) & (alc$famsup == "no"))
values[3]<- sum((!alc$high_use) & (alc$famsup == "yes"))
values[4]<- sum((alc$high_use) & (alc$famsup == "yes"))
df <- expand.grid(c("High", "Low"), c("No support", "Support"))
g2 <- ggplot(df, aes(x = Var1, y=Var2)) + geom_point(aes(size = values), colour = "green") + theme_bw()
g2 + scale_size_continuous(range=c(10,30))
values <- rep(x = 0, 4)
values[1]<- sum((!alc$high_use) & (alc$famsup == "no"))
values[2]<- sum((alc$high_use) & (alc$famsup == "no"))
values[3]<- sum((!alc$high_use) & (alc$famsup == "yes"))
values[4]<- sum((alc$high_use) & (alc$famsup == "yes"))
df <- expand.grid(c("High", "Low"), c("No support", "Support"))
g2 <- ggplot(df, aes(x = Var1, y=Var2)) + geom_point(aes(size = values), colour = "green") + theme_bw() + xlab("") + ylab("")
g2 + scale_size_continuous(range=c(10,30))
values <- rep(x = 0, 4)
values[1]<- sum((!alc$high_use) & (alc$famsup == "no"))
values[2]<- sum((alc$high_use) & (alc$famsup == "no"))
values[3]<- sum((!alc$high_use) & (alc$famsup == "yes"))
values[4]<- sum((alc$high_use) & (alc$famsup == "yes"))
df <- expand.grid(c( "Low","High"), c("No support", "Support"))
g2 <- ggplot(df, aes(x = Var1, y=Var2)) + geom_point(aes(size = values), colour = "green") + theme_bw() + xlab("") + ylab("")
g2 + scale_size_continuous(range=c(10,30))
sum(values)
values = values/sum(values)
values
values <- rep(x = 0, 4)
values[1]<- sum((!alc$high_use) & (alc$famsup == "no"))
values[2]<- sum((alc$high_use) & (alc$famsup == "no"))
values[3]<- sum((!alc$high_use) & (alc$famsup == "yes"))
values[4]<- sum((alc$high_use) & (alc$famsup == "yes"))
values = values/sum(values)
df <- expand.grid(c( "Low","High"), c("No support", "Support"))
g2 <- ggplot(df, aes(x = Var1, y=Var2)) + geom_point(aes(size = values), colour = "green") + theme_bw() + xlab("") + ylab("")
g2 + scale_size_continuous(range=c(10,30))
sum(!alc$high_use)
values[c(1,2)]
values[c(1,3)] = values[c[1,3]]/sum(!alc$high_use)
values[c(1,3)] = values[c(1,3)]/sum(!alc$high_use)
values <- rep(x = 0, 4)
values[1]<- sum((!alc$high_use) & (alc$famsup == "no"))
values[2]<- sum((alc$high_use) & (alc$famsup == "no"))
values[3]<- sum((!alc$high_use) & (alc$famsup == "yes"))
values[4]<- sum((alc$high_use) & (alc$famsup == "yes"))
values[c(1,3)] = values[c(1,3)]/sum(!alc$high_use)
values[c(2,4)] = values[c(2,4)]/sum(alc$high_use)
df <- expand.grid(c( "Low","High"), c("No support", "Support"))
g2 <- ggplot(df, aes(x = Var1, y=Var2)) + geom_point(aes(size = values), colour = "green") + theme_bw() + xlab("") + ylab("")
g2 + scale_size_continuous(range=c(10,30))
values <- rep(x = 0, 4)
values[1]<- sum((!alc$high_use) & (alc$famsup == "no"))
values[2]<- sum((alc$high_use) & (alc$famsup == "no"))
values[3]<- sum((!alc$high_use) & (alc$famsup == "yes"))
values[4]<- sum((alc$high_use) & (alc$famsup == "yes"))
values[c(1,3)] = values[c(1,3)]/sum(!alc$high_use)
values[c(2,4)] = values[c(2,4)]/sum(alc$high_use)
df <- expand.grid(c( "Low","High"), c("No support", "Support"))
g2 <- ggplot(df, aes(x = Var1, y=Var2)) + geom_point(aes(size = values), colour = "green") + theme_bw() + xlab("") + ylab("")
g2 + scale_size_continuous(range=c(10,30)) +geom_text(aes(label = values))
values <- rep(x = 0, 4)
values[1]<- sum((!alc$high_use) & (alc$famsup == "no"))
values[2]<- sum((alc$high_use) & (alc$famsup == "no"))
values[3]<- sum((!alc$high_use) & (alc$famsup == "yes"))
values[4]<- sum((alc$high_use) & (alc$famsup == "yes"))
values[c(1,3)] = values[c(1,3)]/sum(!alc$high_use)
values[c(2,4)] = values[c(2,4)]/sum(alc$high_use)
df <- expand.grid(c( "Low","High"), c("No support", "Support"))
g2 <- ggplot(df, aes(x = Var1, y=Var2)) + geom_point(aes(size = values), colour = "green") + theme_bw() + xlab("") + ylab("")
g2 + scale_size_continuous(range=c(10,30)) +geom_text(aes(label = round(values))
values <- rep(x = 0, 4)
values[1]<- sum((!alc$high_use) & (alc$famsup == "no"))
values[2]<- sum((alc$high_use) & (alc$famsup == "no"))
values[3]<- sum((!alc$high_use) & (alc$famsup == "yes"))
values[4]<- sum((alc$high_use) & (alc$famsup == "yes"))
values[c(1,3)] = values[c(1,3)]/sum(!alc$high_use)
values[c(2,4)] = values[c(2,4)]/sum(alc$high_use)
df <- expand.grid(c( "Low","High"), c("No support", "Support"))
g2 <- ggplot(df, aes(x = Var1, y=Var2)) + geom_point(aes(size = values), colour = "green") + theme_bw() + xlab("") + ylab("")
g2 + scale_size_continuous(range=c(10,30)) +geom_text(aes(label = round(values)))
values <- rep(x = 0, 4)
values[1]<- sum((!alc$high_use) & (alc$famsup == "no"))
values[2]<- sum((alc$high_use) & (alc$famsup == "no"))
values[3]<- sum((!alc$high_use) & (alc$famsup == "yes"))
values[4]<- sum((alc$high_use) & (alc$famsup == "yes"))
values[c(1,3)] = values[c(1,3)]/sum(!alc$high_use)
values[c(2,4)] = values[c(2,4)]/sum(alc$high_use)
df <- expand.grid(c( "Low","High"), c("No support", "Support"))
g2 <- ggplot(df, aes(x = Var1, y=Var2)) + geom_point(aes(size = values), colour = "green") + theme_bw() + xlab("") + ylab("")
g2 + scale_size_continuous(range=c(10,30)) +geom_text(aes(label = round(values, digits = 2)))
values <- rep(x = 0, 4)
values[1]<- sum((!alc$high_use) & (alc$famsup == "no"))
values[2]<- sum((alc$high_use) & (alc$famsup == "no"))
values[3]<- sum((!alc$high_use) & (alc$famsup == "yes"))
values[4]<- sum((alc$high_use) & (alc$famsup == "yes"))
values[c(1,3)] = values[c(1,3)]/sum(!alc$high_use)
values[c(2,4)] = values[c(2,4)]/sum(alc$high_use)
df <- expand.grid(c( "Low","High"), c("No support", "Support"))
g2 <- ggplot(df, aes(x = Var1, y=Var2)) + geom_point(aes(size = values), colour = "green") + theme_bw() + xlab("") + ylab("")
g2 + scale_size_continuous(range=c(10,30)) +geom_text(aes(label = round(values, digits = 2))) + ggtitle("Family educational supprot (Y/N)")
values <- rep(x = 0, 4)
values[1]<- sum((!alc$high_use) & (alc$famsup == "no"))
values[2]<- sum((alc$high_use) & (alc$famsup == "no"))
values[3]<- sum((!alc$high_use) & (alc$famsup == "yes"))
values[4]<- sum((alc$high_use) & (alc$famsup == "yes"))
values[c(1,3)] = values[c(1,3)]/sum(!alc$high_use)
values[c(2,4)] = values[c(2,4)]/sum(alc$high_use)
df <- expand.grid(c( "Low","High"), c("No support", "Support"))
g2 <- ggplot(df, aes(x = Var1, y=Var2)) + geom_point(aes(size = values), colour = "green") + theme_bw() + xlab("") + ylab("")
g2 + scale_size_continuous(range=c(10,30)) +geom_text(aes(label = round(values, digits = 2))) + ggtitle("Family educational supprot (Y/N)")
f1 <- ggplot(alc, aes(x=high_use, y=goout, col = sex))
f1
f1 + geom_bar()
f1 <- ggplot(alc, aes(x=high_use, y=goout, col = sex))
f1 + geom_bar()
f1 <- ggplot(alc, aes(goout))
f1 + geom_bar()
f1 <- ggplot(alc, aes(goout))
f1 + geom_bar(aes(fill = high_use), position = "fill")
f1 <- ggplot(alc, aes(goout))
f1 + geom_bar(aes(fill = high_use), position = "fill") + xlab("Going out with friends")
f1 <- ggplot(alc, aes(goout))
f1 + geom_bar(aes(fill = high_use), position = "fill") + xlab("Going out with friends") + ggtitle("Going out with friends")
f1 <- ggplot(alc, aes(goout))
f1 + geom_bar(aes(fill = high_use), position = "fill") + xlab("Going out") + ggtitle("Going out with friends")
d1 <- ggplot(alc, aes(Pstatus))
d1 + geom_bar(aes(fill = high_use), position = "fill") + xlab("P") + ggtitle()
d1 <- ggplot(alc, aes(Pstatus))
d1 + geom_bar(aes(fill = high_use), position = "fill") + xlab("P") + ggtitle("")
d1 <- ggplot(alc, aes(Pstatus))
d1 + geom_bar(aes(fill = high_use), position = "fill") + xlab("A = Apart, T = Together") + ggtitle("Parents' status")
model <- glm(high_use ~ famrel + famsup + goout + Pstatus, data = alc, family = "binomial")
# print out a summary of the model
summary(model)
model <- glm(high_use ~ famrel + famsup + goout + Pstatus, data = alc, family = "binomial")
summary(model)
OR <- coef(model) %>% exp
CI <- confint(model) %>% exp
cbind(OR, CI)
d1 <- ggplot(alc, aes(Pstatus))
d1 + geom_bar(aes(fill = high_use), position = "fill") + xlab("A = Apart, T = Together") + ggtitle("Parents' status")
model2 <- glm(high_use ~ famrel + goout, data = alc, family = "binomial")
model2 <- glm(high_use ~ famrel + goout, data = alc, family = "binomial")
probabilities <- predict(m, type = "response")
model2 <- glm(high_use ~ famrel + goout, data = alc, family = "binomial")
probabilities <- predict(model2, type = "response")
alc <- mutate(alc, probability = probabilities)
alc <- mutate(alc, prediction = probabilities>0.5)
table(high_use = alc$high_use, prediction = alc$prediction)
model2 <- glm(high_use ~ famrel + goout, data = alc, family = "binomial")
probabilities <- predict(model2, type = "response")
alc <- mutate(alc, probability = probabilities)
alc <- mutate(alc, prediction = probabilities>0.5)
table(high_use = alc$high_use, prediction = alc$prediction)
d2 <- ggplot(alc, aes(x = probability, y = high_use, col = prediction))
d2 + geom_point()
probabilities
model2 <- glm(high_use ~ famrel + goout, data = alc, family = "binomial")
probabilities <- predict(model2, type = "response")
alc <- mutate(alc, probability = probabilities)
alc <- mutate(alc, prediction = probabilities>0.5)
table(high_use = alc$high_use, prediction = alc$prediction)
d2 <- ggplot(alc, aes(x = probability, y = high_use, col = prediction))
d2 + geom_point(position = position_jitter(w=0.1,h=0.1))
model <- glm(high_use ~ famrel + famsup + goout + Pstatus, data = alc, family = "binomial")
summary(model)
OR <- coef(model) %>% exp
CI <- confint(model) %>% exp
cbind(OR, CI)
model <- glm(high_use ~ famrel + famsup + goout + Pstatus, data = alc, family = "binomial")
summary(model)
OR <- coef(model) %>% exp
CI <- confint(model) %>% exp
cbind(OR, CI)
install.packages("magrittr")
install.packages("magrittr")
install.packages("magrittr")
